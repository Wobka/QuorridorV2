#include <stdio.h>
#include "Menu.h"

struct bar {
    int x1;
    int y1;
    int x2;
    int y2;
};

struct joueur {
    int x;
    int y;
    int bar;
    struct bar tab[10];
};


void plateau(struct joueur j1, struct joueur j2, struct bar tab1[],struct bar tab2[], int n) {
    for (int i = 0 ;i < 9; i++) {
        cursor(n,i*4+3);
        printf(" %d ", i+1);
        cursor(i*2+1+n,0);
        printf(" %d ", i+1);
        for (int j = 0; j < 9; j++) {
            if (i+1==j1.x && j+1==j1.y || i+1==j2.x && j+1==j2.y){

            }
            //else {
                cursor(i*2+1+n,j*4+3);
                color(0,15);
                printf("   ");
                color(15,0);
                printf(" ");
            //}
        }
    }
    cursor(n+(j1.x*2-1),j1.y*4-1);
    color(0,15);
    printf(" @ ");
    cursor(j2.x*2-1+n,j2.y*4-1);
    printf(" * ");
    cursor(20+n,0);
    color(15,0);
    printf(" J1 ");
    cursor(23+n,0);
    printf(" J2 ");
    printf("\n\n");
    for (int i = 0; i < 10; i++) {
        cursor(tab1[i].x1+n,tab1[i].y1);
        printf("%c", 0xBA);
    }
    for (int i = 0; i < 10; i++) {
        cursor(tab2[i].x1+n,tab2[i].y1);
        printf("%c", 0xBA);
    }
    printf("\n\n");
}

struct joueur tour(struct joueur j1) {
    printf("Actions possibles: \n1 - deplacer son pion\n2 - poser une barriere\n3 - passer son tour\n4 - annuler la derniere action\n");
    int n,m;
    do {
        printf("Choisissez une action:\n");
        scanf("%d",&n);
    }while (n<1 || n>4);
    if (n==1) {
        printf("Directions possibles: \n");
        if (j1.x<9) {
            printf("1 - Bas\n");
        }
        if (j1.x>1) {
            printf("2 - Haut\n");
        }
        if (j1.y<9) {
            printf("3 - Droite\n");
        }
        if (j1.y>1) {
            printf("4 - Gauche\n");
        }
        do {
            printf("Choisissez une direction:\n");
            scanf("%d",&m);
        }while (m<1 || m>4);
        if (m==1) {
            j1.x++;
        }
        else if (m==2) {
            j1.x--;
        }
        else if (m==3) {
            j1.y++;
        }
        else if (m==4) {
            j1.y--;
        }
    }
    else if (n==2) {

    }
    n = 0;
    return j1;
}

int main(void)
{
    struct joueur j1;
    j1.x = 1;
    j1.y = 5;
    j1.bar = 10;
    j1.tab[10];
    struct joueur j2;
    j2.x = 9;
    j2.y = 5;
    j2.bar = 10;
    j2.tab[10];
    for (int i = 0; i < 10; i++) {
        j1.tab[i].x1=20;
        j1.tab[i].y1=i*3+5;
        j1.tab[i].x2=21;
        j1.tab[i].y2=i*3+5;
        cursor(j1.tab[i].x1,j1.tab[i].y1);
        printf("%c", 0xBA);
    }
    for (int i = 0; i < 10; i++) {
        j2.tab[i].x1=23;
        j2.tab[i].y1=i*3+5;
        j2.tab[i].x2=24;
        j2.tab[i].y2=i*3+5;
        cursor(j2.tab[i].x1,j2.tab[i].y1);
        printf("%c", 0xBA);
    }

    for (int i = 0; i < 1000; i+=100) {
        plateau(j1,j2,j1.tab,j2.tab,i);
        j1 = tour (j1);
        plateau(j1,j2,j1.tab,j2.tab,i+50);
        j2 = tour(j2);
    }

    return 0;
}
